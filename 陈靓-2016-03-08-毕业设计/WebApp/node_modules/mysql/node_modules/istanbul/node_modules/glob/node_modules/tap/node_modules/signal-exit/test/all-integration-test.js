/* global describe, it */

var exec = require('child_process').exec,
  assert = require('assert')

require('chai').should()
require('tap').mochaGlobals()

var onSignalExit = require('../')

describe('all-signals-integration-test', function () {

  // These are signals that are aliases for other signals, so
  // the result will sometimes be one of the others.  For these,
  // we just verify that we GOT a signal, not what it is.
  function weirdSignal (sig) {
    return sig === 'SIGIOT' ||
      sig === 'SIGIO' ||
      sig === 'SIGSYS' ||
      sig === 'SIGIOT' ||
      sig === 'SIGABRT' ||
      sig === 'SIGPOLL' ||
      sig === 'SIGUNUSED'
  }

  // Exhaustively test every signal, and a few numbers.
  var signals = onSignalExit.signals()
  signals.concat('', 0, 1, 2, 3, 54).forEach(function (sig) {
    var node = process.execPath
    var js = require.resolve('./fixtures/exiter.js')
    it('exits properly: ' + sig, function (done) {
      // travis has issues with SIGUSR1 on Node 0.x.10.
      if (process.en